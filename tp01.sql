ALTER TABLE PILOTE (
    PLNUM INT PRIMARY KEY,
    PLNOM VARCHAR(255),
    PLPRENOM VARCHAR(255),
    VILLE VARCHAR(255),
    SALAIRE INT
);

CREATE TABLE AVION (
    AVNUM INT PRIMARY KEY,
    AVNOM VARCHAR(255),
    CAPACITE INT,
    LOCALISATION VARCHAR(255)
);

CREATE TABLE VOL (
    VOLNUM INT PRIMARY KEY,
    PLNUM INT,
    AVNUM INT,
    VILLEDEP VARCHAR(255),
    VILLEARR VARCHAR(255),
    HEUREDEP TIME,
    HEUREARR TIME,
    FOREIGN KEY (PLNUM) REFERENCES PILOTE(PLNUM),
    FOREIGN KEY (AVNUM) REFERENCES AVION(AVNUM),
    UNIQUE (PLNUM, AVNUM)
);


INSERT INTO PILOTE (PLNUM, PLNOM, PLPRENOM, VILLE, SALAIRE) VALUES
(1, 'MIRANDA', 'SERGE', 'PARIS', 2600); 
INSERT INTO PILOTE (PLNUM, PLNOM, PLPRENOM, VILLE, SALAIRE) VALUES
(2, 'LETHANH', 'NAHN', 'TOULOUSE', 2100);
INSERT INTO PILOTE (PLNUM, PLNOM, PLPRENOM, VILLE, SALAIRE) VALUES
(3, 'TALADOIRE', 'GILLES', 'NICE', 1800);
INSERT INTO PILOTE (PLNUM, PLNOM, PLPRENOM, VILLE, SALAIRE) VALUES
(4, 'CHARBONNIER', 'ANNETTE', 'PARIS', 1700);
INSERT INTO PILOTE (PLNUM, PLNOM, PLPRENOM, VILLE, SALAIRE) VALUES
(5, 'REY', 'CHRISTOPHE', 'TOULOUSE', 1900);
INSERT INTO PILOTE (PLNUM, PLNOM, PLPRENOM, VILLE, SALAIRE) VALUES 
(6, 'CHARBONNIER', 'FABIEN', 'PARIS', 1800);
INSERT INTO PILOTE (PLNUM, PLNOM, PLPRENOM, VILLE, SALAIRE) VALUES
(7, 'PENAULD', 'PIERRE', 'NICE', 1700);
INSERT INTO PILOTE (PLNUM, PLNOM, PLPRENOM, VILLE, SALAIRE) VALUES
(8, 'FOUILHOUX', 'PIERRE', 'LYON', 1500);
INSERT INTO PILOTE (PLNUM, PLNOM, PLPRENOM, VILLE, SALAIRE) VALUES
(9, 'GANNAT', 'CHRISTOPHE', NULL, 1800);
INSERT INTO PILOTE (PLNUM, PLNOM, PLPRENOM, VILLE, SALAIRE) VALUES
(10, 'GADAIX', 'SONIA', 'PARIS', 2000);


INSERT INTO AVION (AVNUM, AVNOM, CAPACITE, LOCALISATION) VALUES
(1, 'A300', 300, 'NICE');
INSERT INTO AVION (AVNUM, AVNOM, CAPACITE, LOCALISATION) VALUES
(2, 'A310', 300, 'NICE');
INSERT INTO AVION (AVNUM, AVNOM, CAPACITE, LOCALISATION) VALUES
(3, 'B707', 250, 'PARIS');
INSERT INTO AVION (AVNUM, AVNOM, CAPACITE, LOCALISATION) VALUES
(4, 'A300', 280, 'LYON');
INSERT INTO AVION (AVNUM, AVNOM, CAPACITE, LOCALISATION) VALUES
(5, 'CONCORDE', 160, 'NICE');
INSERT INTO AVION (AVNUM, AVNOM, CAPACITE, LOCALISATION) VALUES
(6, 'B747', 460, 'PARIS');
INSERT INTO AVION (AVNUM, AVNOM, CAPACITE, LOCALISATION) VALUES
(7, 'B707', 250, 'PARIS');
INSERT INTO AVION (AVNUM, AVNOM, CAPACITE, LOCALISATION) VALUES
(8, 'A310', 300, 'TOULOUSE');
INSERT INTO AVION (AVNUM, AVNOM, CAPACITE, LOCALISATION) VALUES
(9, 'MERCURE', 180, 'LYON');
INSERT INTO AVION (AVNUM, AVNOM, CAPACITE, LOCALISATION) VALUES
(10, 'CONCORDE', 160, 'PARIS');



INSERT INTO VOL (VOLNUM, PLNUM, AVNUM, VILLEDEP, VILLEARR, HEUREDEP, HEUREARR) VALUES
(100, 1, 1, 'NICE', 'TOULOUSE', '1100', '1230');
INSERT INTO VOL (VOLNUM, PLNUM, AVNUM, VILLEDEP, VILLEARR, HEUREDEP, HEUREARR) VALUES
(101, 1, 8, 'PARIS', 'TOULOUSE', '1700', '1830');
INSERT INTO VOL (VOLNUM, PLNUM, AVNUM, VILLEDEP, VILLEARR, HEUREDEP, HEUREARR) VALUES
(102, 2, 1, 'TOULOUSE', 'LYON', '1400', '1600');
INSERT INTO VOL (VOLNUM, PLNUM, AVNUM, VILLEDEP, VILLEARR, HEUREDEP, HEUREARR) VALUES
(103, 5, 3, 'TOULOUSE', 'LYON', '1800', '2000');
INSERT INTO VOL (VOLNUM, PLNUM, AVNUM, VILLEDEP, VILLEARR, HEUREDEP, HEUREARR) VALUES
(104, 9, 1, 'PARIS', 'NICE', '0645', '0815');
INSERT INTO VOL (VOLNUM, PLNUM, AVNUM, VILLEDEP, VILLEARR, HEUREDEP, HEUREARR) VALUES
(105, 10, 2, 'LYON', 'NICE', '1100', '1200');
INSERT INTO VOL (VOLNUM, PLNUM, AVNUM, VILLEDEP, VILLEARR, HEUREDEP, HEUREARR) VALUES
(106, 1, 4, 'PARIS', 'LYON', '0800', '0900');
INSERT INTO VOL (VOLNUM, PLNUM, AVNUM, VILLEDEP, VILLEARR, HEUREDEP, HEUREARR) VALUES
(107, 8, 4, 'NICE', 'PARIS', '0715', '0845');
INSERT INTO VOL (VOLNUM, PLNUM, AVNUM, VILLEDEP, VILLEARR, HEUREDEP, HEUREARR) VALUES
(108, 1, 8, 'NANTES', 'LYON', '0900', '1530');
INSERT INTO VOL (VOLNUM, PLNUM, AVNUM, VILLEDEP, VILLEARR, HEUREDEP, HEUREARR) VALUES
(109, 8, 2, 'NICE', 'PARIS', '1215', '1345');
INSERT INTO VOL (VOLNUM, PLNUM, AVNUM, VILLEDEP, VILLEARR, HEUREDEP, HEUREARR) VALUES
(110, 9, 2, 'PARIS', 'LYON', '1500', '1600');
INSERT INTO VOL (VOLNUM, PLNUM, AVNUM, VILLEDEP, VILLEARR, HEUREDEP, HEUREARR) VALUES
(111, 1, 2, 'LYON', 'NANTES', '1630', '2000');
INSERT INTO VOL (VOLNUM, PLNUM, AVNUM, VILLEDEP, VILLEARR, HEUREDEP, HEUREARR) VALUES
(112, 4, 5, 'NICE', 'LENS', '1100', '1400');
INSERT INTO VOL (VOLNUM, PLNUM, AVNUM, VILLEDEP, VILLEARR, HEUREDEP, HEUREARR) VALUES
(113, 3, 5, 'LENS', 'PARIS', '1500', '1600');
INSERT INTO VOL (VOLNUM, PLNUM, AVNUM, VILLEDEP, VILLEARR, HEUREDEP, HEUREARR) VALUES
(114, 8, 9, 'PARIS', 'TOULOUSE', '1700', '1800');
INSERT INTO VOL (VOLNUM, PLNUM, AVNUM, VILLEDEP, VILLEARR, HEUREDEP, HEUREARR) VALUES
(115, 7, 5, 'PARIS', 'TOULOUSE', '1800', '1900');

* 1. Donner toutes les informations sur les pilotes */
SELECT * FROM PILOTE;

/* 2. Donner le nom et l’adresse des pilotes */
SELECT PLNOM, VILLE FROM PILOTE;

/* 3. Sélectionner l’identificateur et le nom de chaque pilote */
SELECT PLNUM, PLNOM FROM PILOTE;

/* 4. Quelles sont les villes de départ des différents vols */
SELECT DISTINCT VILLEDEP FROM VOL;

/* 5. Sélectionner les noms des pilotes habitant Paris */
SELECT PLNOM FROM PILOTE WHERE VILLE = 'PARIS';

/* 6. Sélectionner les noms des pilotes gagnant plus de 2500 Euros */
SELECT PLNOM FROM PILOTE WHERE SALAIRE > 2500;

/* 7. Quels sont les noms des pilotes dont l’adresse est inconnue */
SELECT PLNOM FROM PILOTE WHERE VILLE IS NULL;

/* 8. Sélectionner les avions de nom A310, A320, A330, A340 */
SELECT * FROM AVION WHERE AVNOM IN ('A310', 'A320', 'A330', 'A340');

/* 9. Quels sont les noms des pilotes gagnant entre 2000 et 2500 Euros */
SELECT PLNOM FROM PILOTE WHERE SALAIRE BETWEEN 2000 AND 2500;

/* 10. Quelles sont les capacités des avions de type Airbus */
SELECT CAPACITE FROM AVION WHERE AVNOM LIKE 'A%';

/* 11. Quels sont les noms des avions différents de A310, A320, A330, A340 */
SELECT AVNOM FROM AVION WHERE AVNOM NOT IN ('A310', 'A320', 'A330', 'A340');

/* 12. Quels sont les vols au départ de Nice desservant Paris */
SELECT * FROM VOL WHERE VILLEDEP = 'NICE' AND VILLEARR = 'PARIS';

/* 13. Quel est le salaire moyen des pilotes parisiens */
SELECT AVG(SALAIRE) FROM PILOTE WHERE VILLE = 'PARIS';

/* 14. Quel est le nombre de vols au départ de Paris */
SELECT COUNT(*) FROM VOL WHERE VILLEDEP = 'PARIS';

/* 15. Quels sont les pilotes dont le salaire est plus élevé que le salaire moyen des pilotes */
SELECT PLNOM FROM PILOTE WHERE SALAIRE > (SELECT AVG(SALAIRE) FROM PILOTE);

/* 16. Quels sont les noms des pilotes en service au départ de Paris */
SELECT DISTINCT PLNOM FROM PILOTE P JOIN VOL V ON P.PLNUM = V.PLNUM WHERE VILLEDEP = 'PARIS';

/* 17. Quels sont les noms des pilotes niçois qui gagnent plus que tous les pilotes parisiens */
SELECT PLNOM FROM PILOTE WHERE VILLE = 'NICE' AND SALAIRE > ALL (SELECT SALAIRE FROM PILOTE WHERE VILLE = 'PARIS');

/* 18. Quels sont les noms des pilotes niçois qui gagnent plus qu’au moins un pilote parisien */
SELECT PLNOM FROM PILOTE WHERE VILLE = 'NICE' AND SALAIRE > ANY (SELECT SALAIRE FROM PILOTE WHERE VILLE = 'PARIS');

/* 19. Rechercher les pilotes ayant même adresse et même salaire que MIRANDA */
SELECT PLNOM FROM PILOTE WHERE VILLE = (SELECT VILLE FROM PILOTE WHERE PLNOM = 'MIRANDA') AND SALAIRE = (SELECT SALAIRE FROM PILOTE WHERE PLNOM = 'MIRANDA');

/* 20. Donner la liste des pilotes parisiens par ordre de salaire décroissant puis par ordre alphabétique des noms */
SELECT PLNOM FROM PILOTE WHERE VILLE = 'PARIS' ORDER BY SALAIRE DESC, PLNOM;

/* 21. Quel est le nombre de vols effectués par chacun des pilotes */
SELECT PLNUM, COUNT(*) AS NOMBRE_DE_VOLS FROM VOL GROUP BY PLNUM;

/* 22. Quel est le nombre de vols par pilote et par avion */
SELECT PLNUM, AVNUM, COUNT(*) AS NOMBRE_DE_VOLS FROM VOL GROUP BY PLNUM, AVNUM;

/* 23. Donner le nombre de vols par pilote seulement s’il est supérieur à 5 */
SELECT PLNUM, COUNT(*) AS NOMBRE_DE_VOLS FROM VOL GROUP BY PLNUM HAVING COUNT(*) > 5;

/* 24. Donner le nom des pilotes effectuant au moins 5 vols */
SELECT PLNOM FROM PILOTE WHERE PLNUM IN (SELECT PLNUM FROM VOL GROUP BY PLNUM HAVING COUNT(*) >= 5);

/* 25. Quels sont les noms des avions de capacité supérieure à 250 ou localisés à PARIS */
SELECT AVNOM FROM AVION WHERE CAPACITE > 250 OR LOCALISATION = 'PARIS';

/* 26. Quels sont les numéros des pilotes pilotant les avions 2 et 4 */
SELECT DISTINCT PLNUM FROM VOL WHERE AVNUM IN (2, 4) GROUP BY PLNUM HAVING COUNT(DISTINCT AVNUM) = 2;

/* 27. Quels sont les numéros des pilotes pilotant l’avion 2 mais jamais le 4 */
SELECT DISTINCT PLNUM FROM VOL WHERE AVNUM = 2 AND PLNUM NOT IN (SELECT PLNUM FROM VOL WHERE AVNUM = 4);